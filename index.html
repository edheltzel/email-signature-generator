<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Weston & Associates Email Signature Generator</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.4.1/css/bulma.min.css"
    />
    <style>.message.is-primary{background-color: white !important;}</style>
  </head>
  <body>
    <section class="section">
      <div class="container">
        <div class="heading">
          <h1 class="title">Generate your branded signature:</h1>
          <div class="content">
            <ol>
              <li>Fill out all the fields below that are applicable.</li>
              <li>
                Proceed to instructions for your email client (gmail)
                below "signatures" section.
              </li>
            </ol>
          </div>
        </div>
      </div>
    </section>
    <section class="section">
      <div class="container">
        <div class="columns">
          <div class="column">
            <h3 class="title">Your information:</h3>
            <form id="form">
              <div class="field is-horizontal">
                <div class="field-label is-normal">
                  <label class="label" for="name">Name:</label>
                </div>
                <div class="field-body">
                  <div class="field has-addons has-addons-centered">
                    <p class="control is-expanded">
                      <input
                        id="name"
                        class="input"
                        placeholder="First & Last Name"
                      />
                    </p>
                  </div>
                </div>
              </div>
              <div class="field is-horizontal">
                <div class="field-label is-normal">
                  <label class="label" for="position">Position:</label>
                </div>
                <div class="field-body">
                  <div class="field has-addons has-addons-centered">
                    <p class="control is-expanded">
                      <input
                        id="position"
                        class="input"
                        placeholder="This is what I do"
                      />
                    </p>
                  </div>
                </div>
              </div>
              <div class="field is-horizontal">
                <div class="field-label is-normal">
                  <label class="label" for="checkPhone">Phone:</label>
                </div>
                <div class="field-body">
                  <div class="field has-addons has-addons-centered">
                    <p class="control">
                      <label
                        class="button is-static"
                        title="Check when need insert phone"
                      >
                        <input id="checkPhone" type="checkbox" />
                      </label>
                    </p>
                    <p class="control is-expanded">
                      <input
                        id="phone"
                        class="input"
                        placeholder="(937) 555-5555"
                        disabled
                      />
                    </p>
                  </div>
                </div>
              </div>
              <div class="field is-horizontal">
                <div class="field-label is-normal">
                  <label class="label" for="checkSkype">Skype:</label>
                </div>
                <div class="field-body">
                  <div class="field has-addons has-addons-centered">
                    <p class="control">
                      <label
                        class="button is-static"
                        title="Check when need insert skype"
                      >
                        <input id="checkSkype" type="checkbox" />
                      </label>
                    </p>
                    <p class="control is-expanded">
                      <input
                        id="skype"
                        class="input"
                        placeholder="skypename"
                        disabled
                      />
                    </p>
                  </div>
                </div>
              </div>
              <div class="field is-horizontal">
                <div class="field-label is-normal">
                  <label class="label" for="email">Email:</label>
                </div>
                <div class="field-body">
                  <div class="field has-addons has-addons-centered">
                    <p class="control is-expanded">
                      <input
                        id="email"
                        class="input"
                        placeholder="name@westonacllc.com"
                      />
                    </p>
                  </div>
                </div>
              </div>
              <div class="field is-horizontal">
                <div class="field-label is-normal">
                  <label class="label" for="checkIcons">Icons:</label>
                </div>
                <div class="field-body">
                  <div class="field has-addons has-addons-centered">
                    <p class="control">
                      <label class="button is-static">
                        <input id="checkIcons" type="checkbox" />
                      </label>
                    </p>
                    <p class="control is-expanded">
                      <input
                        id="network"
                        class="input"
                        placeholder="Hide social icons?"
                        disabled
                      />
                    </p>
                  </div>
                </div>
              </div>
              <div class="field is-horizontal">
                <div class="field-label is-normal">
                  <label class="label" for="checkLogo">Logo:</label>
                </div>
                <div class="field-body">
                  <div class="field has-addons has-addons-centered">
                    <p class="control">
                      <label class="button is-static">
                        <input id="checkLogo" type="checkbox" />
                      </label>
                    </p>
                    <p class="control is-expanded">
                      <input
                        id="logo"
                        class="input"
                        placeholder="Hide logo?"
                        disabled
                      />
                    </p>
                  </div>
                </div>
              </div>
              <!-- <div class="field is-horizontal">
              <div class="field-label is-normal">
                  <label class="label" for="facebook">Facebook:</label>
              </div>
              <div class="field-body">
                  <div class="field has-addons has-addons-centered">
                      <p class="control is-expanded">
                          <input id="facebook" class="input" placeholder="https://facebook.com/user/">
                      </p>
                  </div>
              </div>
          </div>
          <div class="field is-horizontal">
              <div class="field-label is-normal">
                  <label class="label" for="twitter">Twitter:</label>
              </div>
              <div class="field-body">
                  <div class="field has-addons has-addons-centered">
                      <p class="control is-expanded">
                          <input id="twitter" class="input" placeholder="https://twitter.com/user/">
                      </p>
                  </div>
              </div>
          </div>
          <div class="field is-horizontal">
              <div class="field-label is-normal">
                  <label class="label" for="linkedin">LinkedIn:</label>
              </div>
              <div class="field-body">
                  <div class="field has-addons has-addons-centered">
                      <p class="control is-expanded">
                          <input id="linkedin" class="input" placeholder="https://linkedin.com/user/">
                      </p>
                  </div>
              </div>
          </div> -->
              <div class="field is-horizontal">
                <div class="field-label is-normal">
                  <label class="label" for="checkImage">Banner:</label>
                </div>
                <div class="field-body">
                  <div class="field has-addons has-addons-centered">
                    <p class="control">
                      <label
                        class="button is-static"
                        title="Check when need insert banner"
                      >
                        <input id="checkImage" type="checkbox" />
                      </label>
                    </p>
                    <p class="control is-expanded">
                      <input
                        id="image"
                        class="input"
                        placeholder="https://i.imgur.com/xnLswkr.gif"
                        disabled
                      />
                      <span class="help">
                        Use <a href="https://imgur.com/">imgur.com</a> for hosting images

                      </span>
                    </p>
                  </div>
                </div>
              </div>
            </form>
          </div>
          <div class="column">
            <h3 class="title" >
              Preview:
            </h3>
              <span class="control" id="company" style="display: grid; grid-template-columns: repeat(3, 1fr); grid-gap: .4rem; padding-bottom: 1rem;">
                <span class="radio" style="display: none"></span>
                <label class="radio">
                  <input type="radio" name="company" value="weston" checked />
                  Weston
                </label>
                <label class="radio" style="grid-column: span 2;">
                  <input type="radio" name="company" value="spbw" />
                  Speciality Products
                </label>
                <label class="radio">
                  <input type="radio" name="company" value="ssl" />
                  Sur-Seal Liners
                </label>
                <label class="radio">
                  <input type="radio" name="company" value="ssc" />
                  Sur-Seal Covers
                </label>
                <label class="radio">
                  <input type="radio" name="company" value="eb" />
                  Enviro-Box
                </label>
              </span>
            <article class="message is-primary">
              <div class="message-body" id="signature_container">
                <table cellspacing="0" cellpadding="0" id="signature">
                  <tbody>
                    <tr>
                      <td
                        style="
                          padding-left: 10px;
                          color: rgb(12, 15, 17);
                          font-family: Helvetica, Arial, sans-serif;
                          font-size: 12px;
                          line-height: 16px;
                        "
                        colspan="2"
                      >
                        <span
                          class="name"
                          id="preparedName"
                          style="color: rgb(46, 113, 183); font-weight: bold;"
                        >
                          Name </span
                        ><br />
                        <span class="position">
                          Fancy Job Title...
                        </span>
                        <br />
                        <div id="phoneWrap"></div>
                        <!-- <div id="skypeWrap"></div> -->
                        <span style="white-space: nowrap;">
                          <a
                            class="email"
                            href="mailto:name@gmail.com"
                            style="
                              color: rgb(12, 15, 17);
                              text-decoration: none;
                            "
                          >
                            name@gmail.com
                          </a>
                        </span>
                        <br />
                        <br />
                        <span style="white-space: nowrap;" id="logoWrap">
                          <img src="" class="logo" />
                        </span>
                        <div id="imageWrap"></div>
                        <hr />
                      </td>
                    </tr>
                    <tr>
                      <td
                        style="
                          padding-left: 10px;
                          white-space: nowrap;
                          vertical-align: middle;
                        "
                      >
                        <font size="4" color="rgb(12, 15, 17)" face="Arial"
                          >Follow us:&nbsp;</font
                        >
                        <span class="Apple-converted-space"></span>
                      </td>
                      <td style="vertical-align: middle;">
                        <a
                          style="
                            text-decoration: none;
                            color: transparent;
                            margin-top: 5px;
                          "
                          class="facebook"
                          href="https://www.facebook.com/westonacllc/"
                          ><img
                            shrinktofit="true"
                            src="https://i.imgur.com/PgoTAbI.png"
                            height="24"
                            width="24"
                        /></a>

                        <!-- <span class="Apple-converted-space">&nbsp;</span>
                        <a
                          style="
                            text-decoration: none;
                            color: transparent;
                            margin-top: 5px;
                          "
                          class="twitter"
                          href="https://twitter.com/westonacllc"
                          ><img
                            shrinktofit="true"
                            src="https://i.imgur.com/90tJmUf.png"
                            height="24"
                            width="24"
                        /></a> -->

                        <span class="Apple-converted-space">&nbsp;</span>
                        <a
                          style="
                            text-decoration: none;
                            color: transparent;
                            margin-top: 5px;
                          "
                          class="linkedin"
                          href="https://www.linkedin.com/company/weston-and-associates-llc"
                          ><img
                            shrinktofit="true"
                            src="https://i.imgur.com/x8x6L3X.png"
                            height="24"
                            width="24"
                        /></a>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </article>
            <h3 class="title">Signatures:</h3>
            <div class="controls">
              <button
                class="button is-primary"
                data-select
                data-signature="signature"
              >
                Select Signature (for Gmail)
              </button>
              <!-- <button
                class="button is-info"
                data-prepare
                data-signature="signature"
              >
                Prepare HTML (for Thunderbird)
              </button>
              <a
                class="button is-primary is-hidden"
                data-load
                download="NRG_signature.htm"
              >
                Save HTML to file
              </a> -->
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="section">
      <div class="container">
        <article class="message is-info">
          <div class="message-header">
            Email client instructions
          </div>
          <div class="message-body content">
            <div class="columns">
              <div class="column">
                <h4 class="title">Adding the signature to Gmail:</h4>
                <div class="instructions">
                  <p>
                    Visit help page
                    <a
                      href="https://support.google.com/mail/answer/8395?co=GENIE.Platform%3DDesktop&hl=en"
                      >https://support.google.com/mail/answer/8395?co=GENIE.Platform%3DDesktop&amp;hl=en</a
                    >
                  </p>
                  <p>
                    Or below is a quick gif that illustrates the steps above.
                  </p>
                  <img src="https://i.imgur.com/DH82U74.gif" />
                </div>
              </div>
              <!-- <div class="column">
                <h4 class="title">Adding the signature to Thunderbird:</h4>
                <div class="instructions">
                  <p>
                    Visit help page
                    <a href="https://support.mozilla.org/en-US/kb/signatures"
                      >https://support.mozilla.org/en-US/kb/signatures</a
                    >
                  </p>
                  <p>
                    Or below is a quick gif that illustrates the steps above.
                  </p>
                  <img
                    src="https://facemail.click/uploads/2016/03/image31.gif"
                  />
                </div>
              </div> -->
            </div>
          </div>
        </article>
      </div>
    </section>
    <script>
      (function (w) {
        var doc = w.document;
        var inputs = doc.querySelectorAll('form .input');
        var select = doc.querySelector('[data-select]');
        var prepare = doc.querySelector('[data-prepare]');
        var download = doc.querySelector('[data-load]');
        var banner = doc.querySelector('#checkImage');
        var checkPhone = doc.querySelector('#checkPhone');
        var phoneInput = doc.querySelector('#phone');
        var phoneWrap = doc.querySelector('#phoneWrap');
        // var checkSkype = doc.querySelector('#checkSkype');
        // var skypeInput = doc.querySelector('#skype');
        // var skypeWrap = doc.querySelector('#skypeWrap');
        var checkIcons = doc.querySelector('#checkIcons');
        var checkLogo = doc.querySelector('#checkLogo');
        var tableSignature = doc.querySelector('#signature > tbody');
        var savedNode = null;
        var savedLogo = null;

        var logoWrap = doc.querySelector('#logoWrap');
        var bannerWrap = doc.querySelector('#imageWrap');
        var bannerInput = doc.querySelector('#image');
        var companyRadio = doc.querySelectorAll('#company input');
        var logo = doc.querySelector('.logo');

        var westonLogo =
          'https://i.imgur.com/Bet9370.png';

        var spbwLogo =
          'https://i.imgur.com/AGQCvnL.png';

        var sslLogo =
          'https://i.imgur.com/6pGjdjl.png';

        var sscLogo =
          'https://i.imgur.com/WQXuVAF.png';

        var ebLogo =
          'https://i.imgur.com/FiNbHNh.png';

        var styleName = doc.querySelector('#preparedName');

        logo.src = westonLogo;
        for (var i = companyRadio.length - 1; i >= 0; i--) {
          companyRadio[i].addEventListener('click', changeCompany);
        }
        function changeCompany(e) {
          switch (e.target.value) {
            case 'weston':
              logo.src = westonLogo;
              styleName.style.color = 'rgb(46, 113, 183)';
              break;
            case 'spbw':
              logo.src = spbwLogo;
              styleName.style.color = 'rgb(12, 15, 17)';
              break;
            case 'ssl':
              logo.src = sslLogo;
              styleName.style.color = 'rgb(28, 59, 177)';
              break;
            case 'ssc':
              logo.src = sscLogo;
              styleName.style.color = 'rgb(141, 95, 230)';
              break;
            case 'eb':
              logo.src = ebLogo;
              styleName.style.color = 'rgb(49, 190, 177)';
          }
        }

        for (var i = inputs.length - 1; i >= 0; i--) {
          inputs[i].addEventListener('keyup', updateSignature);
        }

        checkPhone.addEventListener('click', function () {
          if (!this.checked) {
            phoneInput.disabled = true;
            removeHtmlNodes(phoneWrap);
          } else {
            phoneInput.disabled = false;
            addHtmlNodes(phoneWrap, '(937) 555-5555', 'phone');
          }
        });
        checkSkype.addEventListener('click', function () {
          if (!this.checked) {
            skypeInput.disabled = true;
            removeHtmlNodes(skypeWrap);
          } else {
            skypeInput.disabled = false;
            addHtmlNodes(skypeWrap, 'skypename', 'skype');
          }
        });
        function removeHtmlNodes(node) {
          node.innerHTML = '';
        }
        function addHtmlNodes(node, data, className) {
          var br = doc.createElement('br');
          var span = doc.createElement('span');
          span.classList.add(className);
          span.innerHTML = data;
          node.appendChild(span);
          node.appendChild(br);
        }
        checkIcons.addEventListener('click', function () {
          this.checked ? removeIcons() : addIcons();
        });
        function removeIcons() {
          savedNode = tableSignature.removeChild(
            tableSignature.lastElementChild
          );
        }
        function addIcons() {
          tableSignature.appendChild(savedNode);
        }

        checkLogo.addEventListener('click', function () {
          this.checked ? removeLogo() : addLogo();
        });
        function removeLogo() {
          savedLogo = logoWrap.removeChild(logoWrap.lastElementChild);
        }
        function addLogo() {
          logoWrap.appendChild(savedLogo);
        }

        banner.addEventListener('click', function () {
          if (!this.checked) {
            bannerInput.disabled = true;
            removeBanner();
          } else {
            bannerInput.disabled = false;
            createBanner();
          }
        });

        function createBanner(src) {
          var checkLink = bannerWrap.querySelector('a');
          var br = doc.createElement('br');
          var img = doc.createElement('img');
          img.src = src ? src : 'https://i.imgur.com/biz9i8t.gif';
          img.classList.add('image');
          img.width = '600';
          img.height = '60';
          var link = doc.createElement('a');
          link.href = 'https://westonandassociates.com/';

          if (checkLink) {
            bannerWrap.querySelector('img').src = src;
          } else {
            link.appendChild(img);
            bannerWrap.appendChild(br);
            bannerWrap.appendChild(br);
            bannerWrap.appendChild(link);
          }
        }

        function removeBanner() {
          bannerWrap.innerHTML = '';
          doc.querySelector('#image').value = '';
        }

        function updateSignature(e) {
          var id = e.target.id;
          var value = e.target.value;
          var element = doc.querySelector('.' + id);
          var checkBanner = banner.checked;

          if (id === 'email') {
            element.href = 'mailto:' + value;
            element.innerHTML = value;
          } else if (id === 'facebook') {
            element.href = value;
          } else if (id === 'twitter') {
            element.href = value;
          } else if (id === 'linkedin') {
            element.href = value;
          } else if (id === 'image') {
            if (checkBanner) {
              createBanner(value);
            }
          } else {
            element.innerHTML = value;
          }
          download.classList.add('is-hidden');
          prepare.classList.remove('is-hidden');
        }

        select.addEventListener('click', selectGmail);
        prepare.addEventListener('click', prepareHTML);

        function selectGmail(event) {
          var id = event.target.dataset.signature;
          var element = doc.querySelector('#' + id);
          selectText(element);
        }
        function prepareHTML() {
          var html = doc.querySelector('#signature_container').innerHTML;
          download.href = 'data:text/html, ' + html;
          download.classList.remove('is-hidden');
          prepare.classList.add('is-hidden');
        }

        // from SO: https://stackoverflow.com/a/987376/1592915
        function selectText(element) {
          if (doc.body.createTextRange) {
            range = doc.body.createTextRange();
            range.moveToElementText(element);
            range.select();
          } else if (w.getSelection) {
            selection = w.getSelection();
            range = doc.createRange();
            range.selectNodeContents(element);
            selection.removeAllRanges();
            selection.addRange(range);
          }
        }
      })(window);
    </script>
  </body>
</html>
